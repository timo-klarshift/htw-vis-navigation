package vis.db

import java.sql.Connection
import java.sql.Statement

class SqlHelper {
	Connection con;
	
	SqlHelper(Connection con){
		this.con = con;
	}
	
	public static String readSchema(ClassLoader cl , String resourcePath){
		return cl.getResource(resourcePath).getText()
	}
	
	public boolean execute(String sql){
		Statement stmt = con.createStatement()
		return stmt.execute(sql)
	}
	
	public void createImageTable(int layerId){
		h.execute("drop table if exists images_${layerId}");
		String schema = SqlHelper.readSchema(getClass().getClassLoader(), "images.sql");
		schema = schema.replaceAll("\\[LOD\\]", layerId);
		h.execute(schema);
	}

}
