package vis.db;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import vis.config.VisConfig;
import vis.logging.VisLog;

public class FeatureDump {

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// init
		VisConfig.load();
		VisLog.initLogging();
		
		Connection con = ConnectionFactory.getByName("features");
		
		
		
		// fetch loop
		
		try {
			int bulk = 10000;
			for(int i=0; i<17000000; i+=bulk){
				Statement stmt = con.createStatement();
				ResultSet rs = stmt.executeQuery("select fotolia_id, feature_vectors from image limit " + i + "," + bulk);
				System.out.println(i + "," + bulk);
				while(rs.next()){
					int fId = rs.getInt(1);
					byte[] features = rs.getBytes(2);
					
				}
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

}
