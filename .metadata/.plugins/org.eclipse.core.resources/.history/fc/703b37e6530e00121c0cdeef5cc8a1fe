package vis.db;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;


/**
 * implement caching
 * @author timo
 *
 */
class VisualFeatures {
	Connection con;
	PreparedStatement stmt;
	
	public VisualFeatures(){
		init();
	}
	
	private void init(){
		// do database connection
		con = ConnectionFactory.getByName("features");
		
		// select statement
		stmt = con.prepareStatement("select feature_vectors from image where fotolia_id=? limit 1");
	}	
	
	public byte[] getFeature(Integer fotoliaId){
		
		byte[] features;		
		
		// set params
		stmt.setInt(1, fotoliaId);
		
		// query and read
		ResultSet rs = stmt.executeQuery();			
		if(rs.next()){			
			features = rs.getBytes(1);			
		}			
			
		return features;
	}
	
	public void shutdown(){
		con.close();
	}


}
