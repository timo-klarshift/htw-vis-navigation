package vis.importer;

import java.sql.Connection;

import org.apache.log4j.Logger;

import vis.db.ConnectionFactory;
import vis.db.SqlHelper;

/**
 * reads from database
 * and writes an index with lucene
 * 
 * @author timo
 *
 */
public class DbIndexer {
	private Connection con;
	private int layerId;
	private String indexPath;
	private Logger log = Logger.getLogger(this.getClass());
	private SqlHelper sql;
	
	public DbIndexer(int layerId, String indexPath){
		this.layerId = layerId;
		this.indexPath = indexPath;
		
		init();
	}
	
	private void init(){
		// create connection
		con = ConnectionFactory.getByName("images");
		
		sql = new SqlHelper(con);
		// create index
		
	}
	
	public void shutdown(){
		con.close();
	}
	
	public void index(int layerId){
		int max = getMaxId();
		int min = getMinId();
	}
	
	private int _numberSelect(String type){
		
	}
	
	private int getMaxId(){
		return _numberSelect("MAX(id)");
	}
	
	private int getMinId(){
		return _numberSelect("MIN(id)");
	}

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		DbIndexer indexer = new DbIndexer();
		indexer.index(0);

	}

}
