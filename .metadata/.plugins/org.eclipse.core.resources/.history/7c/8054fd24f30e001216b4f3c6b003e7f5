package vis.clustering.quad;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.HashSet;
import java.util.Set;

import logging.VisLog;
import vis.config.VisConfig;
import vis.db.ConnectionFactory;
import vis.db.SqlHelper;

public class QuadPosition {
	Connection con;
	
	public QuadPosition(){
		this.con = ConnectionFactory.getByName("images");
	}
	
	public void write(int startLayer){
		// get laycount
		SqlHelper h = new SqlHelper(con);
		int imageCount = h.max("images_"+startLayer);
		System.out.println(imageCount);
		
		int n = (int) Math.sqrt(imageCount);
		int x = 0;
		int y = 0;
		int c = 0;
		
		// get a set of all ids
		Set<Integer> ids = new HashSet<Integer>();
		Statement stmt = con.createStatement();
		ResultSet rs = stmt.executeQuery("select * from images_" + startLayer);
		while(rs.next()){
			x = c % n;
			y = c / n;
			System.out.println(x + "/" + y);
			// get image, set position
			
			
			
			c++;
		}
		
				
	}

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		VisConfig.load();
		VisLog.initLogging();
		// TODO Auto-generated method stub
		new QuadPosition().write(7);
	}

}
